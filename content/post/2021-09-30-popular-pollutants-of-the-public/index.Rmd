---
title: "Popular Pollutants of The Public"
description: "Analysis on data collected from plastic bottles barcodes"
author: "Peter Boshe"
date: '2021-09-30'
slug: []
categories: ["R"]
tags: ["R programming","Visualization","Data Analysis"]
output:
  blogdown::html_page:
    toc: true
    toc_depth: 2
summary: "Who are the leading pollutants of our state? you probably have a good guess as to who these popular pollutants are, but by all means dive in to find out more"
draft: true
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.align = 'center', collapse = FALSE)
```
## Load The Data Set

The data was collected by [Wastebase's Data Partner](https://www.unwaste.io/partners) by methods decribed on this [source page](https://www.kaggle.com/wastebase/plastic-bottle-waste)

```{r data, warning=FALSE, message=FALSE}
require(tidyverse)
require(skimr)
require(forcats)
require(knitr)
data <- read_csv("wastebase_scan_summary_20210815.csv")
```

## inspect the data



```{r inspect data, echo=FALSE}
skim_without_charts(data)
```

Note: consider cleaning product size data, currently on 95 units

### change strings as factors
```{r factors}
data$scan_country <- factor(data$scan_country)
data$manufacturer_country <- factor(data$manufacturer_country)
data$manufacturer_name <- factor(data$manufacturer_name)
```

## Exploratory Analysis

### Total count of bottles per country
```{r total count}
data %>%
  group_by(scan_country) %>%
  summarise(total_bottles = sum(bottle_count)) %>%
  arrange(desc(total_bottles))
```

Note: email data collectors to query on the data discrepancy

### Total count of bottles produced per manufacturer in Tanzania
```{r total per manufacturer in TZ}
tz_data <- data %>% filter(scan_country == "TZ")
tz_data %>%
  group_by(manufacturer_name) %>%
  summarise(total_bottles = sum(bottle_count)) %>%
  arrange(desc(total_bottles))
```

### Total count of bottles as per manufacturer country
```{r total per manufacturer country}
tz_data %>%
  group_by(manufacturer_country) %>%
  summarise(total_bottles = sum(bottle_count)) %>%
  arrange(desc(total_bottles))

```

### Inspect TZ data
```{r}
glimpse(tz_data)
```

### get ranking of bottlecount as per brand name
```{r}
tz_data %>% group_by(brand_name) %>% summarise(total = sum(bottle_count)) %>% arrange(desc(total))
```

### get ranking of bottle count as per product label

```{r}
tz_data %>% group_by(product_label) %>% summarise(total = sum(bottle_count)) %>% arrange(desc(total))
```

### collapse factors with variating names
```{r collapsing factors}

drinking_water <- c("Pure Drinking Water", "Drinking Water", "Drinking water", "pure drinking water", "Mineral Water", "Mineral water", "Mineral water", "Agua Mineral Natural de las Sierras", "Best drinking water", "still drinking water", "Premium Pure Drinking Water", "DRINKING WATER", "Natural Water")

carbonated_soft_drinks <- c("Xtra Carbonated Drink", "Extra Berry Flavor Carbonated Soft Drink", "Pineapple Flavoured Carbonated Soft Drink","Coke","Fanta Orange", "Pineapple Carbonated Drink", "Passion Flavour Carbonated Drink", "Xtra Berry Flavoured Carbonated Soft Drink", "Carbonated soft drink stoney Tangawizi/ ginger", "Cola Carbonated Soft Drink", "Malt Flavoured", "Non Alcoholic Malt Drink", "Fruity Flavoured Soft Drink", "Energy drink","CARBONATED FLAVOURED DRINK", "Afiya Berries Flavour","Chungwa","Pepsi", "Pepsi Max", "Apple punch", "Mo Xtra Energy")

wine <- c("Fortified Wine")

alcohol <- c("K-Vant Spirit", "Gin", "Castle Lite", "Potable cane spirit", "Kilimanjaro Premium Lager", "Savanna", "")

juice <- c("Mango juice drink", "Fruit drink","Orange Dairy Blend Concentrate", "Lemon-Lime Flavoured Drink", "Mango Fruit Juice Drink (Azam Embe)", "Ukwaju Tamarind Juice Drink", "Ubuyu / Baobab Fruit Drink", "Orange Flavored Drink", "Mango juice drink", "Tunda Embe / Mango Juice Drink", "Delight Mango Flavoured Drink", "Embe Flavoured Drink", "Jembe Drink", "Ukwaju")

tz_data_collapsed <- tz_data %>% mutate(product_label_collapsed = fct_collapse(product_label, "Drinking Water" = drinking_water, "Carbonated Soft Drinks" = carbonated_soft_drinks, "Wine" = wine, "Juice" = juice, "Alcoholic Drinks" = alcohol)) %>% group_by(product_label_collapsed) %>% summarise(total = sum(bottle_count)) %>% arrange(desc(total))

kable(tz_data_collapsed, align = "cc")
```

